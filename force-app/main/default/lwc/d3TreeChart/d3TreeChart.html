<template>
  <div class="chart-box">
    <!-- Loading State -->
    <template if:true={displaySpinner}>
      <div class="loading-overlay">
        <lightning-spinner
          alternative-text="Loading visualization..."
          size="medium"
          variant="brand"
        ></lightning-spinner>
      </div>
    </template>

    <!-- Main Visualization -->
    <template if:true={treeData}>
      <div class="d3" lwc:dom="manual"></div>
    </template>
    
    <!-- Enhanced Error State -->
    <template if:false={displaySpinner}>
      <template if:false={treeData}>
        <div class="error-state">
          <c-empty-large-illustration-view 
            title="Visualization Unavailable" 
            body={errorBody}>
          </c-empty-large-illustration-view>
        </div>
      </template>
    </template>
  </div>
</template>